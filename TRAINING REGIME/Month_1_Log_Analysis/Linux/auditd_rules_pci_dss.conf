# Auditd Rules for Practical SOC Monitoring
# Based on PCI DSS and CIS Benchmarks

# Remove existing rules
-D

# Buffer Size
-b 8192

# Monitor for execution of suspicious tools
-a always,exit -F arch=b64 -S execve -k suspicious_exec
-w /usr/bin/whoami -p x -k dev_triage
-w /usr/bin/netstat -p x -k network_triage
-w /usr/bin/nmap -p x -k scanning_activity

# Monitor for file deletions and modifications in /etc
-w /etc/passwd -p wa -k identity_modification
-w /etc/shadow -p wa -k identity_modification
-w /etc/sudoers -p wa -k privilege_escalation

# Monitor for SSH activity
-w /var/log/auth.log -p wa -k ssh_logs
-w /root/.ssh/authorized_keys -p wa -k ssh_persistence

# Monitor for Cron job modifications
-w /etc/cron.d/ -p wa -k persistence_cron
-w /var/spool/cron/ -p wa -k persistence_cron

# Lock the configuration
-e 2
